(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{196:function(e,t,s){var a={"./af":68,"./af.js":68,"./ar":69,"./ar-dz":70,"./ar-dz.js":70,"./ar-kw":71,"./ar-kw.js":71,"./ar-ly":72,"./ar-ly.js":72,"./ar-ma":73,"./ar-ma.js":73,"./ar-sa":74,"./ar-sa.js":74,"./ar-tn":75,"./ar-tn.js":75,"./ar.js":69,"./az":76,"./az.js":76,"./be":77,"./be.js":77,"./bg":78,"./bg.js":78,"./bm":79,"./bm.js":79,"./bn":80,"./bn.js":80,"./bo":81,"./bo.js":81,"./br":82,"./br.js":82,"./bs":83,"./bs.js":83,"./ca":84,"./ca.js":84,"./cs":85,"./cs.js":85,"./cv":86,"./cv.js":86,"./cy":87,"./cy.js":87,"./da":88,"./da.js":88,"./de":89,"./de-at":90,"./de-at.js":90,"./de-ch":91,"./de-ch.js":91,"./de.js":89,"./dv":92,"./dv.js":92,"./el":93,"./el.js":93,"./en-SG":94,"./en-SG.js":94,"./en-au":95,"./en-au.js":95,"./en-ca":96,"./en-ca.js":96,"./en-gb":97,"./en-gb.js":97,"./en-ie":98,"./en-ie.js":98,"./en-il":99,"./en-il.js":99,"./en-nz":100,"./en-nz.js":100,"./eo":101,"./eo.js":101,"./es":102,"./es-do":103,"./es-do.js":103,"./es-us":104,"./es-us.js":104,"./es.js":102,"./et":105,"./et.js":105,"./eu":106,"./eu.js":106,"./fa":107,"./fa.js":107,"./fi":108,"./fi.js":108,"./fo":109,"./fo.js":109,"./fr":110,"./fr-ca":111,"./fr-ca.js":111,"./fr-ch":112,"./fr-ch.js":112,"./fr.js":110,"./fy":113,"./fy.js":113,"./ga":114,"./ga.js":114,"./gd":115,"./gd.js":115,"./gl":116,"./gl.js":116,"./gom-latn":117,"./gom-latn.js":117,"./gu":118,"./gu.js":118,"./he":119,"./he.js":119,"./hi":120,"./hi.js":120,"./hr":121,"./hr.js":121,"./hu":122,"./hu.js":122,"./hy-am":123,"./hy-am.js":123,"./id":124,"./id.js":124,"./is":125,"./is.js":125,"./it":126,"./it-ch":127,"./it-ch.js":127,"./it.js":126,"./ja":128,"./ja.js":128,"./jv":129,"./jv.js":129,"./ka":130,"./ka.js":130,"./kk":131,"./kk.js":131,"./km":132,"./km.js":132,"./kn":133,"./kn.js":133,"./ko":134,"./ko.js":134,"./ku":135,"./ku.js":135,"./ky":136,"./ky.js":136,"./lb":137,"./lb.js":137,"./lo":138,"./lo.js":138,"./lt":139,"./lt.js":139,"./lv":140,"./lv.js":140,"./me":141,"./me.js":141,"./mi":142,"./mi.js":142,"./mk":143,"./mk.js":143,"./ml":144,"./ml.js":144,"./mn":145,"./mn.js":145,"./mr":146,"./mr.js":146,"./ms":147,"./ms-my":148,"./ms-my.js":148,"./ms.js":147,"./mt":149,"./mt.js":149,"./my":150,"./my.js":150,"./nb":151,"./nb.js":151,"./ne":152,"./ne.js":152,"./nl":153,"./nl-be":154,"./nl-be.js":154,"./nl.js":153,"./nn":155,"./nn.js":155,"./pa-in":156,"./pa-in.js":156,"./pl":157,"./pl.js":157,"./pt":158,"./pt-br":159,"./pt-br.js":159,"./pt.js":158,"./ro":160,"./ro.js":160,"./ru":161,"./ru.js":161,"./sd":162,"./sd.js":162,"./se":163,"./se.js":163,"./si":164,"./si.js":164,"./sk":165,"./sk.js":165,"./sl":166,"./sl.js":166,"./sq":167,"./sq.js":167,"./sr":168,"./sr-cyrl":169,"./sr-cyrl.js":169,"./sr.js":168,"./ss":170,"./ss.js":170,"./sv":171,"./sv.js":171,"./sw":172,"./sw.js":172,"./ta":173,"./ta.js":173,"./te":174,"./te.js":174,"./tet":175,"./tet.js":175,"./tg":176,"./tg.js":176,"./th":177,"./th.js":177,"./tl-ph":178,"./tl-ph.js":178,"./tlh":179,"./tlh.js":179,"./tr":180,"./tr.js":180,"./tzl":181,"./tzl.js":181,"./tzm":182,"./tzm-latn":183,"./tzm-latn.js":183,"./tzm.js":182,"./ug-cn":184,"./ug-cn.js":184,"./uk":185,"./uk.js":185,"./ur":186,"./ur.js":186,"./uz":187,"./uz-latn":188,"./uz-latn.js":188,"./uz.js":187,"./vi":189,"./vi.js":189,"./x-pseudo":190,"./x-pseudo.js":190,"./yo":191,"./yo.js":191,"./zh-cn":192,"./zh-cn.js":192,"./zh-hk":193,"./zh-hk.js":193,"./zh-tw":194,"./zh-tw.js":194};function n(e){var t=r(e);return s(t)}function r(e){if(!s.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=r,e.exports=n,n.id=196},65:function(e,t,s){"use strict";s.r(t);var a=s(0),n=s.n(a),r=s(67),l=s.n(r),o=s(31);const j={apiUrl:"https://saindev.bitrix24.ru/rest/1/",apiKey:"jnhh17dws952m9tv",companyID:1};var c=s(197),i=s(198),h=s(199),m=s(200),u=s(201);var d=({dealId:e})=>{const[t,s]=Object(a.useState)([]);if(Object(a.useEffect)(()=>{!async function(){await fetch(j.apiUrl+j.apiKey+"/tasks.task.list/?filter[UF_CRM_TASK]=D_"+e).then(e=>e.json()).then(e=>{const t=e.result.tasks;s(t)},e=>{this.setState({isLoaded:!0,error:e})})}()},[]),t)return n.a.createElement("ul",null,t.map(e=>n.a.createElement("li",{key:e.id},e.title.replace("CRM: ",""))))};class p extends a.Component{render(){const e=this.props.deal;return n.a.createElement("tr",null,n.a.createElement("td",null,n.a.createElement("div",null,n.a.createElement("h6",null,e.TITLE)),n.a.createElement(d,{dealId:e.ID})),n.a.createElement("td",null,parseInt(e.OPPORTUNITY)))}}var f=class extends a.Component{render(){const e=[];var t=0;return l.a.locale("ru"),this.props.deals.forEach(s=>{e.push(n.a.createElement(p,{deal:s,key:s.ID})),t+=parseInt(s.OPPORTUNITY)}),n.a.createElement(c.a,null,n.a.createElement(i.a,{striped:!0,bordered:!0,hover:!0},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",{colSpan:"2"},n.a.createElement(c.a,null,n.a.createElement(h.a,null,n.a.createElement(m.a,{className:"text-left"},n.a.createElement(u.a,{as:"input",type:"button",value:"<",onClick:this.props.toPrevMonth})),n.a.createElement(m.a,{className:"align-self-center text-center"},n.a.createElement("h4",null,l()().month(this.props.month).subtract(1,"months").format("MMMM"))),n.a.createElement(m.a,{className:"text-right"},n.a.createElement(u.a,{as:"input",type:"button",value:">",onClick:this.props.toNextMonth})))))),n.a.createElement("tr",null,n.a.createElement("th",null,"Название"),n.a.createElement("th",null,"Цена (руб)"))),n.a.createElement("tbody",null,e),n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("th",null,"Итого"),n.a.createElement("th",null,t)))))}};function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}s.d(t,"default",function(){return E});class E extends a.Component{constructor(e){super(e),this.state={error:null,isLoaded:!1,deals:{},currentMonth:l()().month(),beginDate:l()().subtract(2,"months").endOf("month").format("DD.MM.YYYY"),closeDate:l()().startOf("month").format("DD.MM.YYYY")},this.toPrevMonth=this.toPrevMonth.bind(this),this.toNextMonth=this.toNextMonth.bind(this)}switch(e){const t=parseInt(this.state.currentMonth)+e,s=l()().month(t).endOf("month").subtract(2,"months").format("DD.MM.YYYY"),a=l()().month(t).startOf("month").format("DD.MM.YYYY");this.setState({currentMonth:t,beginDate:s,closeDate:a,deals:{},isLoaded:!1})}toPrevMonth(){this.switch(-1)}toNextMonth(){this.switch(1)}async getTasks(){await fetch(j.apiUrl+j.apiKey+"/crm.deal.list/?order[BEGINDATE]=ASC&filter[%3EBEGINDATE]="+this.state.beginDate+"&filter[%3CCLOSEDATE]="+this.state.closeDate+"&filter[COMPANY_ID]="+j.companyID).then(e=>e.json()).then(e=>{this.setState({deals:e.result,isLoaded:!0})},e=>{this.setState({isLoaded:!0,error:e})})}componentDidMount(){this.getTasks()}componentDidUpdate(e,t){this.state.currentMonth!==t.currentMonth&&this.getTasks()}render(){const{toPrevMonth:e,toNextMonth:t}=this,{error:s,isLoaded:a,deals:r,currentMonth:l}=this.state;return s?n.a.createElement("div",null,"Ошибка: ",s.message):a?n.a.createElement(f,b({deals:r,month:l},{toPrevMonth:e,toNextMonth:t})):n.a.createElement(o.a,{size:"sm","aria-labelledby":"contained-modal-title-vcenter",centered:!0,show:!0,onHide:()=>{}},n.a.createElement(o.a.Body,null,n.a.createElement("h4",null,"Загрузка...")))}}}}]);